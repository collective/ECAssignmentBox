<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
                      "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="eduComponents">
<body>
<metal:block fill-slot="css_slot">
  <style type="text/css" media="screen"
    tal:content="string: @import url($portal_url/ecabstyles.css);"></style>
</metal:block>

<metal:main fill-slot="main">
  <tal:main-macro metal:define-macro="main"
       tal:define="Iterator      python: modules['Products.Archetypes'].IndexIterator;
                   tabindex      python: Iterator();
                   auto_feedback here/auto_feedback|nothing;"
  >

    <div metal:use-macro="here/document_actions/macros/document_actions"/>
  
    <!-- print page title -->    
    <h1 class="documentFirstHeading">
     <a tal:attributes="name here/aq_parent/id"
      tal:content="here/aq_parent/title_or_id"/>
    </h1>

    <a href=""
     class="link-parent"
     tal:define="parent_url python:here.navigationParent(here, template_id)"
     tal:condition="parent_url"
     tal:attributes="href parent_url"
     i18n:domain="plone"
     i18n:translate="go_to_parent_url">
     Up one level
    </a>

    <a class="link-down"
     tal:attributes="href python: '#' + here.getId()">
     <span i18n:translate="go_to_submission">Go to the submission of</span>
     <span tal:replace="here/getCreatorFullName"/></a>

    <!-- display the assignment text -->
    <dl class="collapsible collapsedBlockCollapsible">
     <dt class="collapsibleHeader"
      i18n:translate="assignment_text">Assignment text</dt>
     <dd class="collapsibleContent">
      <div class="documentDescription"
       tal:content="structure here/aq_parent/Description"
       tal:condition="here/aq_parent/Description"/>

      <div tal:replace="structure here/aq_parent/getAssignment_text"/>
     </dd>
    </dl>

    <p/>

    <!-- print all relevant fields -->
    <h1>
     <a i18n:translate="assignment_of"
      tal:attributes="name here/getId"
      >Assignment of</a>
     <span tal:replace="here/getCreatorFullName"/>
    </h1>

    <a tal:attributes="href string: #${here/aq_parent/id}"
     i18n:translate="back_to_overview"
     class="link-parent">Back to the assignment text</a>

    <div class="documentByLine">
      <span i18n:translate="label_datetime">Submitted at</span>
      <span tal:content="python: here.toPortalTime(here.CreationDate(), 1)"/>
    </div>

    <div class="field"
        tal:define="answer here/getAsPlainText;">
      <label for="answer" i18n:translate="label_answer">Answer:</label>

      <p class="discreet" tal:content="here/file/getContentType"/>

      <pre id="answer" tal:condition="answer" tal:content="answer"/>

      <div tal:define="field python:here.getField('file');
                       unit here/file;">
          <a href="" 
             tal:define="fieldName python:field.getName();"
             tal:attributes="href string:${here/absolute_url}/at_download/$fieldName">
            <img tal:define="icon unit/getBestIcon | nothing;"
                 tal:condition="icon" 
                 src=""
                 tal:attributes="src string:${here/portal_url}/$icon"/>
            <span tal:replace="unit/filename"/>
            (<span tal:content="python:here.lookupMime(unit.getContentType())">ContentType</span>
            <span tal:define="size unit/get_size | python:unit and len(unit) or 0;"
                tal:content="python:'%sKb' % (size / 1024)"/>)
          </a>
      </div>

    </div>

    <!--
    <div tal:condition="not: here/source">
     <div class="field" tal:condition="here/file">
      <label for="source" i18n:translate="label_source">Source:</label>
      <p class="discreet" tal:content="here/file/getContentType"/>
      <pre id="source" tal:content="here/getAsPlainText"/>
     </div>
    </div>

    <tal:block tal:define="field_macro field_macro|here/widgets/field/macros/view;
                           mode string:view;
                           use_label python:1">
      <div tal:define="field python: here.getField('file')">
        <span metal:use-macro="field_macro"/>
      </div>
    </tal:block>
    -->

    <a tal:attributes="href string: #${here/aq_parent/id}"
     i18n:translate="back_to_overview"
     class="link-parent">Back to the assignment text</a>

    <div class="field" tal:condition="here/getFeedback">
      <label for="feedback" i18n:translate="label_feedback">Feedback:</label>
      <div id="feedback" tal:content="structure here/getFeedback"/>
    </div>

    <div class="field" tal:condition="here/getMark">
      <span i18n:translate="msg_marked_with">Your assignment was graded:</span>
      <strong tal:content="here/getMark"/>
    </div>

    <div metal:use-macro="here/document_byline/macros/byline">
      Get the byline - contains details about author and modification date.
    </div>

  </tal:main-macro>
</metal:main>

</body>
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode:xml
sgml-local-catalogs:("/usr/local/lib/sgml/XHTML11.cat")
sgml-validate-command:"xmllint \\-\\-valid \\-\\-noout %s %s"
sgml-indent-step:1
sgml-indent-data:t
fill-column:79
End:
-->
