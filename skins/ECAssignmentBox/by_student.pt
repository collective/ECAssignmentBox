<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
                      "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    lang="en"
    metal:use-macro="here/main_template/macros/master"
    i18n:domain="eduComponents">

  <body>
    <metal:block fill-slot="css_slot">
      <style type="text/css" media="screen"
	tal:content="string: @import url($portal_url/ecabstyles.css);"></style>
    </metal:block>

    <metal:main fill-slot="main"
      tal:define="n_boxes python: here.countContainedBoxes()">
      <tal:main-macro metal:define-macro="main">

	<div metal:use-macro="here/document_actions/macros/document_actions">
	  Document actions (print, sendto, etc.)
	</div>
	
	<h1 class="documentFirstHeading" i18n:translate="label_submissions">
	  Students
	</h1>

	<p>
	  <b i18n:translate="label_n_boxes">Published assignment boxes inside this folder</b>:
	  <span tal:omit-tag="" tal:content="n_boxes"/>
	  <br/>

	  <span tal:omit-tag="" tal:condition="here/completedStates">
	    <span tal:omit-tag="" tal:condition="here/projectedAssignments">
	      <b i18n:translate="label_projected_assignments">Projected Number of Assignments</b>:
	      <span tal:omit-tag="" tal:replace="here/projectedAssignments"/>
	      <br/>
	    </span>

	    <b i18n:translate="label_completed_states">Completed States</b>:
	    <span tal:omit-tag="" tal:replace="python: ', '.join(here.completedStates)"/>
	  </span>
	</p>

	<table class="listing">
	  <thead>
	    <tr>
	      <th i18n:translate="label_user">User</th>

	      <tal:block tal:condition="here/completedStates">
		<th i18n:translate="label_completed">Completed</th>
		<th i18n:translate="label_completed_curr">%&nbsp;Curr.</th>
		<th i18n:translate="label_completed_proj" tal:condition="here/projectedAssignments">%&nbsp;Proj.</th>
	      </tal:block>

	      <tal:block tal:repeat="state python: here.getWfStates()">
		<th tal:content="string: ${state} (%)" tal:attributes="class python: 'state-' + putils.normalizeString(state)"/>
	      </tal:block>
	    </tr>
	  </thead>

	  <tbody style="text-align: right"
	    tal:define="
	    summary   python: here.summarize();
	    items     python: here.rework(summary);
	    completed python: here.summarizeCompletedAssignments(summary);">
	    <tal:block tal:repeat="student items">
	      <tr
		tal:define="oddrow repeat/student/odd;"
                tal:attributes="class python: test(oddrow, 'odd', 'even')">
		<td style="text-align: left">
		  <a tal:content="python: student[1]"
		    tal:attributes="href python: 'all_assignments?userName=%s' % student[0]"></a>
		</td>
	      <tal:block tal:condition="here/completedStates">
		<tal:block tal:define="c python: completed[student[0]]">
		  <td tal:content="c"/>
		  <td><span tal:replace="python: '%.2f' % round(float(c)/n_boxes * 100, 2)"/></td>
		  <td tal:condition="here/projectedAssignments">
		    <span tal:replace="python: '%.2f' % round(float(c)/here.projectedAssignments * 100, 2)"/></td>
		</tal:block>
	      </tal:block>
              <tal:block tal:repeat="state python: student[2]">
                <td><span tal:replace="state"/> (<span tal:replace="python: '%.2f' % round(float(state)/n_boxes * 100, 2)"/>)</td>
              </tal:block>
            </tr>
	    </tal:block>
	  </tbody>
	</table>
      </tal:main-macro>
    </metal:main>
  </body>
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode:xml
sgml-local-catalogs:("/usr/local/lib/sgml/XHTML11.cat")
sgml-validate-command:"xmllint \\-\\-valid \\-\\-noout %s %s"
sgml-indent-step:2
sgml-indent-data:t
fill-column:79
End:
-->
